<%-include("../../views/partials/userPartial/header")%>

<style>
  .wishlist-symbol {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  color: red;
  font-size: 20px;
  cursor: pointer;
}
.wishlist-symbol:focus {
  outline: none;
  box-shadow: none;
}

</style>
  <!-- Header Banner -->
  <section class="hero text-center bg-light p-0">
    <div class="banner position-relative">
      <img src="wallpaper\wall3.jpg" alt="Shop Banner" class="img-fluid w-100" style="height: 400px; object-fit: cover;">
      <h1 class="position-absolute top-50 start-50 translate-middle text-white fw-bold display-4">SHOP NOW</h1>
    </div>
  </section>
  



  <div class="container mt-5">
    <div class="row">

      <!-- Filter Sidebar -->
      <div class="col-md-3">
        <div class="filter-section">
          <h5>Categories</h5>
          <ul class="list-unstyled">
            <% categories.forEach((category)=> { %>
              <li>
                <a href="#" class="text-decoration-none text-dark d-block py-1">
                  <%= category.name %>
                </a>
              </li>
              <% }) %>
          </ul>
          <hr>

          <h5>Product Size</h5>
          <div><input type="checkbox"> S</div>
          <div><input type="checkbox"> M</div>
          <div><input type="checkbox"> L</div>
          <div><input type="checkbox"> XL</div>
          <hr>
          <h5>Price Range</h5>
          <input type="range" class="form-range">
          <p>₹500 - ₹3000</p>
        </div>
      </div>

      <div class="col-md-9">
        <div class="d-flex mb-3">
          <input type="text" class="form-control me-2" placeholder="Search products...">
          <button class="btn btn-dark">Search</button>
        </div>

        <div class="row">
          <% for(let i=0;i<products.length;i++) { %>
            <div class="col-md-4">
              <div class="product-card">
                <img src="<%= products[i].productImage[0] %>" class="w-100">
                <h5>
                  <%= products[i].productName %>
                </h5>
                <p class="price-tag">₹<%= products[i].regularPrice %>
                </p>
                <div class="d-flex justify-content-between">
                  <small>Available Size : <%= products[i].size %></small>
                  <a href="/product-details/<%=products[i]._id%>"><button class="btn btn-outline-dark btn-sm">View
                      Details</button></a>
                  <button class="wishlist-symbol" onclick="addToWishlist('<%=products[i]._id%>')">&#10084;</button>
                  <button class="wishlist-symbol" onclick="addToCart('<%=products[i]._id%>')">&#128722;</button>
                </div>
              </div>
            </div>
            <% } %>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-3">
          <div style="color: #fff;">Showing 1 of <%= totalPages %>
          </div>
          <nav>
            <ul class="pagination mb-0">
              <li class="page-item <%= currentPage == 1 ? 'disabled' : '' %>">
                <a class="page-link" href="?page=<%= currentPage - 1 %>&search=<%= search %>">‹</a>
              </li>

              <% for (let i=1; i <=totalPages; i++) { %>
                <li class="page-item <%= currentPage == i ? 'active' : '' %>">
                  <a class="page-link" href="?page=<%= i %>&search=<%= search %>">
                    <%= i %>
                  </a>
                </li>
                <% } %>

                  <li class="page-item <%= currentPage == totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= currentPage + 1 %>&search=<%= search %>">›</a>
                  </li>
            </ul>
          </nav>

        </div>
      </div>
    </div>

  </div>
  </div>

  
  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>

      function addToWishlist(productId) {

        axios.post("/addToWishlist", { productId })
          .then(function (responce) {
            if (responce.data.success) {
              Swal.fire({
                title: `Add To Wishlist`,
                icon: 'success',
                showConfirmButton:false,
                timer: 1500
              })
            } else {
              Swal.fire({
                title: "Error Occured",
                icon: "error",
                showConfirmButton:false,
                text: responce.data.message,
                timer: 1500
              })
            }
          }).catch((error)=>{
            Swal.fire({
                title: "Error Occured",
                icon: "error",
                showConfirmButton:false,
                text:"Internal Server Error",
                timer: 1500
              })
          })
      }
      function addToCart(productId) {

        axios.post("/addToCart", { productId })
          .then(function (responce) {
            if (responce.data.success) {
              Swal.fire({
                title: `Add To Cart`,
                icon: 'success',
                showConfirmButton:false,
                timer: 1500
              })
            } else {
              Swal.fire({
                title: "Error Occured",
                icon: "error",
                showConfirmButton:false,
                text: responce.data.message,
                timer: 1500
              })
            }
          }).catch((error)=>{
            Swal.fire({
                title: "Error Occured",
                icon: "error",
                showConfirmButton:false,
                text:"Internal Server Error",
                timer: 1500
              })
          })
      }

      </script>
      <%-include("../../views/partials/userPartial/footer")%>