<%-include("../../views/partials/adminPartial/header")%>

  <style>
    body {
      background-color: #0f172a;
      color: #f1f5f9;
      font-family: 'Segoe UI', sans-serif;
    }

    .main-content {
      padding: 30px;
    }

    .card {
      background-color: #1e293b;
      border: none;
      padding: 20px;
      border-radius: 10px;
    }

    .table th,
    .table td {
      color: #f1f5f9;
      vertical-align: middle;
    }

    .btn-add {
      background-color: #22d3ee;
      color: #0f172a;
      border: none;
    }

    .btn-add:hover {
      background-color: #06b6d4;
    }

    .search-bar {
      background-color: #1e293b;
      border: none;
      color: #f1f5f9;
    }

    .search-bar::placeholder {
      color: #94a3b8;
    }

    .pagination .page-link {
      background-color: #1e293b;
      border: none;
      color: #f1f5f9;
    }

    .pagination .active>.page-link {
      background-color: #3b82f6;
      border-radius: 5px;
    }
  </style>
  </head>

  <body>

    <div class="main-content">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Categories</h2>
        <div class="d-flex align-items-center gap-3">
          <input type="text" class="form-control search-bar" placeholder="Search for User Name" style="width: 250px;">
          <div>Admin</div>
        </div>
      </div>

      <div class="card">
        <div class="d-flex justify-content-end mb-3">
          <a href="/admin/add-category" class="btn btn-add">ADD CATEGORY +</a>
        </div>

        <table class="table">
          <thead>
            <tr>
              <th style="color: #000;">NO</th>
              <th style="color: #000;">CATEGORY</th>
              <th style="color: #000;">CATEGORY DESCRIPTION</th>
              <th style="color: #000;">OFFER PRICE</th>
              <th style="color: #000;">OFFER</th>
              <th style="color: #000;">ACTIONS</th>
            </tr>
          </thead>
          <tbody>
            <%if(categories){%>
              <% categories.forEach((category, index)=> { %>
                <tr>
                  <td class="text-start" style="color: #000;">
                    <%= index + 1 %>
                  </td>
                  <td class="text-start" style="color: #000;"><strong>
                      <%= category.name %>
                    </strong></td>
                  <td class="text-start" style="color: #000;">
                    <%= category.description %>
                  </td>
                  <td class="text-start" style="color: #000;">
                    <%= category.offerPrice %>
                  </td>
                  <td class="text-start" style="color: #000;">
                    <%= category.offer %>
                  </td>
                  <td>
                    <%if(category.status == "Unlisted"){%>
                      <button class="btn btn-unlist btn-sm" style="background-color: green; color: #fff;"
                        onClick="Listed('<%=category._id%>','<%=category.name%>')">List</button>
                      <%}else{%>
                        <button class="btn btn-list btn-sm" style="background-color: rgb(255, 0, 0); color: #fff;"
                          onClick="Unlisted('<%=category._id%>','<%=category.name%>')">Unlist</button>
                        <%}%>
                    <a href="/admin/edit-category/<%= category._id %>" class="text-dark me-2"><i
                        class="bi bi-pencil"></i></a>
                  </td>
                </tr>
                <% }) %>
                  <%}%>

          </tbody>
        </table>

        <div class="d-flex justify-content-between align-items-center mt-3">
          <div style="color: #fff;">Showing 1 of <%= totalPages %>
          </div>rs
          <nav>
            <ul class="pagination mb-0">
              <li class="page-item <%= currentPage == 1 ? 'disabled' : '' %>">
                <a class="page-link" href="?page=<%= currentPage - 1 %>&search=<%= search %>">‹</a>
              </li>

              <% for (let i=1; i <=totalPages; i++) { %>
                <li class="page-item <%= currentPage == i ? 'active' : '' %>">
                  <a class="page-link" href="?page=<%= i %>&search=<%= search %>">
                    <%= i %>
                  </a>
                </li>
                <% } %>

                  <li class="page-item <%= currentPage == totalPages ? 'disabled' : '' %>">
                    <a class="page-link" href="?page=<%= currentPage + 1 %>&search=<%= search %>">›</a>
                  </li>
            </ul>
          </nav>

        </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <script>
        function Unlisted(id, name) {
          Swal.fire({
            title: 'Unlisted',
            text: "do you want Unlist this Category?",
            icon: "warning",
            showConfirmButton: true,
            showCancelButton: true
          }).then((result) => {
            if (result.isConfirmed) {
              axios.patch("/admin/Unlist-category", { id })
                .then(function (responce) {
                  if (responce.data.success) {
                    Swal.fire({
                      title: `${name} unlisted`,
                      icon: 'success',
                      showConfirmButton: false,
                      timer: 1500
                    }).then(() => {
                      window.location.reload()
                    })
                  }
                })
            }
          })
        }

        function Listed(id, name) {
          Swal.fire({
            tittle: "List the Category",
            text: "do you want list the user",
            icon: "warning",
            showConfirmButton: true,
            showCancelButton: true
          }).then((result) => {
            if (result.isConfirmed) {
              axios.patch("/admin/list-category", { id })
                .then(function (responce) {
                  if (responce.data.success) {
                    Swal.fire({
                      title: `${name} listed`,
                      icon: 'success',
                      showConfirmButton: false,
                      timer: 1500
                    }).then(() => {
                      window.location.reload()
                    })
                  }
                })
            }
          })
        }
      </script>
  </body>

  </html>